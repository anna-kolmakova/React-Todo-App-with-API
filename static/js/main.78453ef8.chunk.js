(this["webpackJsonpreact-typescript-starter-pack"]=this["webpackJsonpreact-typescript-starter-pack"]||[]).push([[0],{27:function(e,t,n){},30:function(e,t,n){},33:function(e,t,n){"use strict";n.r(t);var r,c=n(16),a=(n(25),n(26),n(27),n(1)),o=n.n(a),s=n(13),i=n(2),l=n.n(i),u=n(5),d=n(3);!function(e){e.Add="Unable to add a todo",e.Delete="Unable to delete a todo",e.Update="Unable to update a todo",e.Title="Title can't be empty",e.Data="Unable to load data",e.noUser="No user found"}(r||(r={}));var f,j=n(4),p=n.n(j),b=n(0),m=function(e){var t=e.error,n=e.setError;return Object(a.useEffect)((function(){var e=setTimeout((function(){n(null)}),3e3);return function(){clearTimeout(e)}}),[]),Object(b.jsxs)("div",{"data-cy":"ErrorNotification",className:p()("notification is-danger is-light has-text-weight-normal",{hidden:null===t}),children:[Object(b.jsx)("button",{"data-cy":"HideErrorButton",type:"button",className:"delete","aria-label":"closeError",onClick:function(){n(null)}}),t]})};!function(e){e.All="All",e.Active="Active",e.Completed="Completed"}(f||(f={}));var h="https://mate.academy/students-api";function O(e){return new Promise((function(t){setTimeout(t,e)}))}function v(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r={method:t};return n&&(r.body=JSON.stringify(n),r.headers={"Content-Type":"application/json; charset=UTF-8"}),O(300).then((function(){return fetch(h+e,r)})).then((function(e){if(!e.ok)throw new Error;return e.json()}))}var x=function(e){return v(e)},g=function(e,t){return v(e,"POST",t)},y=function(e,t){return v(e,"PATCH",t)},N=function(e){return v(e,"DELETE")},T=function(e){return x("/todos?userId=".concat(e))},k=function(e,t){return g("/todos",{userId:e,completed:!1,title:t})},w=function(e){return N("/todos/".concat(e))},C=function(e,t){return y("/todos/".concat(e),t)},_=function(e){var t=e.typeOfFilter,n=e.setTypeOfFilter,c=e.todos,o=e.setTodos,i=e.setError,d=e.completedTodoList,j=Object(a.useMemo)((function(){return c.filter((function(e){return!e.completed}))}),[c]),m=function(){var e=Object(u.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{t.forEach(function(){var e=Object(u.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w(t.id);case 2:o(Object(s.a)(j));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}catch(n){i(r.Delete)}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(b.jsxs)("footer",{className:"todoapp__footer","data-cy":"Footer",children:[Object(b.jsx)("span",{className:"todo-count","data-cy":"todosCounter",children:"".concat(j.length," items left")}),Object(b.jsxs)("nav",{className:"filter","data-cy":"Filter",children:[Object(b.jsx)("a",{"data-cy":"FilterLinkAll",href:"#/",className:p()("filter__link",{selected:t===f.All}),onClick:function(){return n(f.All)},children:"All"}),Object(b.jsx)("a",{"data-cy":"FilterLinkActive",href:"#/active",className:p()("filter__link",{selected:t===f.Active}),onClick:function(){return n(f.Active)},children:"Active"}),Object(b.jsx)("a",{"data-cy":"FilterLinkCompleted",href:"#/completed",className:p()("filter__link",{selected:t===f.Completed}),onClick:function(){return n(f.Completed)},children:"Completed"})]}),Object(b.jsx)("button",{"data-cy":"ClearCompletedButton",type:"button",className:"todoapp__clear-completed",onClick:function(){return m(d)},disabled:0===d.length,children:"Clear completed"})]})},S=function(e){var t=e.newTodoField,n=e.createTodo,r=e.setTitle,c=e.title,o=e.todos,s=e.changeProperty,i=e.setIsToggling,l=o.every((function(e){return e.completed})),u=Object(a.useMemo)((function(){return o.filter((function(e){return!1===e.completed}))}),[o]);return Object(b.jsxs)("header",{className:"todoapp__header",children:[Object(b.jsx)("button",{"data-cy":"ToggleAllButton",type:"button",className:p()("todoapp__toggle-all",{active:l}),"aria-label":"toggle-button",onClick:function(){return u.length>0?(i(!0),u.map((function(e){var t=e.id;return s(t,{completed:!0})}))):(i(!0),o.map((function(e){var t=e.id;return s(t,{completed:!1})})))}}),Object(b.jsx)("form",{onSubmit:n,children:Object(b.jsx)("input",{"data-cy":"NewTodoField",type:"text",ref:t,className:"todoapp__new-todo",placeholder:"What needs to be done?",value:c,onChange:function(e){r(e.target.value)}})})]})},E=n(36),A=n(35),F=function(){return Object(b.jsxs)("div",{"data-cy":"TodoLoader",className:p()("modal overlay is-active"),children:[Object(b.jsx)("div",{className:"modal-background has-background-white-ter"}),Object(b.jsx)("div",{className:"loader"})]})},I=function(e){var t=e.todo,n=e.removeTodo,r=e.changeProperty,c=e.selectedTodoId,o=e.isToggling,s=e.isAdding,i=t.id,l=t.title,u=t.completed,f=Object(a.useState)(!1),j=Object(d.a)(f,2),m=j[0],h=j[1],O=Object(a.useState)(l),v=Object(d.a)(O,2),x=v[0],g=v[1],y=Object(a.useRef)(null);Object(a.useEffect)((function(){y.current&&y.current.focus()}),[m]);var N=Object(a.useCallback)((function(){return n(t.id)}),[t.id]),T=Object(a.useCallback)((function(){return r(i,{completed:!u})}),[i,u]),k=Object(a.useCallback)((function(){if(0===x.trim().length)return n(t.id),void h(!1);x===t.title&&h(!1),r(t.id,{title:x}),h(!1),g("")}),[t.id,m,x,t.title]),w=Object(a.useMemo)((function(){return c===t.id||s&&0===t.id||o}),[t.id,c,s,o]);return Object(b.jsxs)("div",{"data-cy":"Todo",className:p()("todo",{completed:t.completed}),children:[Object(b.jsx)("label",{className:"todo__status-label",children:Object(b.jsx)("input",{"data-cy":"TodoStatus",type:"checkbox",className:"todo__status",onChange:T})}),m?Object(b.jsx)("form",{onSubmit:k,children:Object(b.jsx)("input",{type:"text","data-cy":"TodoTitleField",value:x,ref:y,placeholder:"Empty todo will be deleted",className:"todo__title-field",onBlur:function(){k(),h(!1)},onChange:function(e){g(e.target.value)},onKeyDown:function(e){"Escape"===e.key&&h(!1),"Enter"===e.key&&k()}})}):Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("span",{"data-cy":"TodoTitle",className:"todo__title",onDoubleClick:function(){h(!0),g(l)},children:l}),Object(b.jsx)("button",{type:"button",className:"todo__remove","data-cy":"TodoDeleteButton",onClick:N,children:"\xd7"}),w&&Object(b.jsx)(F,{})]})]},t.id)},L=(n(30),function(e){var t=e.todos,n=e.removeTodo,r=e.changeProperty,c=e.selectedTodoId,a=e.isToggling,o=e.title,s=e.isAdding;return Object(b.jsx)("section",{className:"todoapp__main","data-cy":"TodoList",children:Object(b.jsxs)(E.a,{children:[t.map((function(e){return Object(b.jsx)(A.a,{timeout:300,classNames:"item",children:Object(b.jsx)(I,{todo:e,removeTodo:n,changeProperty:r,selectedTodoId:c,isToggling:a,isAdding:s})},e.id)})),s&&Object(b.jsx)(A.a,{timeout:300,classNames:"temp-item",children:Object(b.jsx)(I,{todo:{id:0,title:o,completed:!1,userId:Math.random()},removeTodo:n,changeProperty:r,selectedTodoId:c,isToggling:a,isAdding:s},Math.random())},0)]})})}),D=function(){var e=Object(u.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x("/users?email=".concat(t));case 2:return n=e.sent,e.abrupt("return",n[0]||null);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),P=function(){var e=Object(u.a)(l.a.mark((function e(t){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.email,r=t.name,e.abrupt("return",g("/users",{email:n,name:r}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),U=function(e){var t=e.onLogin,n=Object(a.useState)(""),r=Object(d.a)(n,2),c=r[0],o=r[1],s=Object(a.useState)(""),i=Object(d.a)(s,2),f=i[0],j=i[1],m=Object(a.useState)(!1),h=Object(d.a)(m,2),O=h[0],v=h[1],x=Object(a.useState)(!1),g=Object(d.a)(x,2),y=g[0],N=g[1],T=Object(a.useState)(""),k=Object(d.a)(T,2),w=k[0],C=k[1],_=function(e){localStorage.setItem("user",JSON.stringify(e)),t(e)};Object(a.useEffect)((function(){var e=localStorage.getItem("user");if(e)try{var n=JSON.parse(e);t(n)}catch(r){}}),[]);var S=function(){var e=Object(u.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D(c);case 2:(t=e.sent)?_(t):v(!0);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),E=function(){var e=Object(u.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),C(""),N(!0),e.prev=3,!O){e.next=9;break}return e.next=7,P({name:f,email:c}).then(_);case 7:e.next=11;break;case 9:return e.next=11,S();case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),C("Something went wrtong");case 16:return e.prev=16,N(!1),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[3,13,16,19]])})));return function(t){return e.apply(this,arguments)}}();return Object(b.jsxs)("form",{onSubmit:E,className:"box mt-5",children:[Object(b.jsx)("h1",{className:"title is-3",children:O?"You need to register":"Log in to open todos"}),Object(b.jsxs)("div",{className:"field",children:[Object(b.jsx)("label",{className:"label",htmlFor:"user-email",children:"Email"}),Object(b.jsxs)("div",{className:p()("control has-icons-left",{"is-loading":y}),children:[Object(b.jsx)("input",{type:"email",id:"user-email",className:p()("input",{"is-danger":!O&&w}),placeholder:"Enter your email",disabled:y||O,value:c,required:!0,onChange:function(e){return o(e.target.value)}}),Object(b.jsx)("span",{className:"icon is-small is-left",children:Object(b.jsx)("i",{className:"fas fa-envelope"})})]}),!O&&w&&Object(b.jsx)("p",{className:"help is-danger",children:w})]}),O&&Object(b.jsxs)("div",{className:"field",children:[Object(b.jsx)("label",{className:"label",htmlFor:"user-name",children:"Your Name"}),Object(b.jsxs)("div",{className:p()("control has-icons-left",{"is-loading":y}),children:[Object(b.jsx)("input",{type:"text",id:"user-name",className:p()("input",{"is-danger":O&&w}),placeholder:"Enter your name",required:!0,minLength:4,disabled:y,value:f,onChange:function(e){return j(e.target.value)}}),Object(b.jsx)("span",{className:"icon is-small is-left",children:Object(b.jsx)("i",{className:"fas fa-user"})})]}),O&&w&&Object(b.jsx)("p",{className:"help is-danger",children:w})]}),Object(b.jsx)("div",{className:"field",children:Object(b.jsx)("button",{type:"submit",className:p()("button is-primary",{"is-loading":y}),children:O?"Register":"Login"})})]})},M=o.a.createContext(null),B=function(e){var t=e.children,n=Object(a.useState)(null),r=Object(d.a)(n,2),c=r[0],o=r[1];return c?Object(b.jsx)(M.Provider,{value:c,children:t}):Object(b.jsx)(U,{onLogin:o})},J=function(){var e=Object(a.useState)([]),t=Object(d.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)(f.All),i=Object(d.a)(o,2),j=i[0],p=i[1],h=Object(a.useState)(null),O=Object(d.a)(h,2),v=O[0],x=O[1],g=Object(a.useState)(""),y=Object(d.a)(g,2),N=y[0],E=y[1],A=Object(a.useState)(null),F=Object(d.a)(A,2),I=F[0],D=F[1],P=Object(a.useState)(!1),U=Object(d.a)(P,2),B=U[0],J=U[1],R=Object(a.useContext)(M),q=Object(a.useRef)(null),H=Object(a.useState)(!1),Y=Object(d.a)(H,2),G=Y[0],K=Y[1],W=(null===R||void 0===R?void 0:R.id)||0,z=function(){var e=Object(u.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=c,e.next=4,T(W);case 4:e.t1=e.sent,(0,e.t0)(e.t1),e.next=11;break;case 8:e.prev=8,e.t2=e.catch(0),x(r.Data);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){q.current&&q.current.focus(),z()}),[]);var Q=Object(a.useMemo)((function(){return n.filter((function(e){switch(j){case f.Active:return!e.completed;case f.Completed:return e.completed;default:return e}}))}),[j,n]),V=Object(a.useCallback)(function(){var e=Object(u.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),K(!0),0!==N.trim().length&&R){e.next=6;break}return x(r.Title),J(!1),e.abrupt("return");case 6:return e.prev=6,e.next=9,k(R.id,N);case 9:n=e.sent,c((function(e){return[].concat(Object(s.a)(e),[n])})),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(6),x(r.Add);case 16:E(""),K(!1);case 18:case"end":return e.stop()}}),e,null,[[6,13]])})));return function(t){return e.apply(this,arguments)}}(),[N,R]),X=function(){var e=Object(u.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return D(t),e.prev=1,e.next=4,w(t);case 4:c((function(e){return e.filter((function(e){return e.id!==t}))})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),x(r.Delete);case 10:D(0);case 11:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}(),Z=function(){var e=Object(u.a)(l.a.mark((function e(t,n){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return D(t),e.prev=1,e.next=4,C(t,n);case 4:a=e.sent,c((function(e){return e.map((function(e){return e.id===t?a:e}))})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),x(r.Update);case 11:D(0),J(!1);case 13:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,n){return e.apply(this,arguments)}}(),$=Object(a.useMemo)((function(){return n.filter((function(e){return e.completed}))}),[n]);return Object(b.jsxs)("div",{className:"todoapp",children:[Object(b.jsx)("h1",{className:"todoapp__title",children:"todos"}),Object(b.jsxs)("div",{className:"todoapp__content",children:[Object(b.jsx)(S,{newTodoField:q,createTodo:V,title:N,setTitle:E,todos:n,changeProperty:Z,setIsToggling:J}),n.length>0&&Object(b.jsx)(L,{todos:Q,removeTodo:X,changeProperty:Z,selectedTodoId:I,isToggling:B,title:N,isAdding:G}),Object(b.jsx)(_,{typeOfFilter:j,setTypeOfFilter:p,todos:n,completedTodoList:$,setError:x,setTodos:c})]}),v&&Object(b.jsx)(m,{error:v,setError:x})]})},R=function(){return Object(b.jsx)(B,{children:Object(b.jsx)(J,{})})};Object(c.createRoot)(document.getElementById("root")).render(Object(b.jsx)(R,{}))}},[[33,1,2]]]);
//# sourceMappingURL=main.78453ef8.chunk.js.map